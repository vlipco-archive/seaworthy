#!/bin/bash

routable_address=10.0.2.15

function start_node() {
	echo "---> Starting $1"
	docker run -d --name $1 -i -t -p $2:$2 -p $2:$2/udp vlipco/deckhouse serf agent \
		-join $routable_address:7946 -node $1 \
		-bind 0.0.0.0:$2 -advertise $routable_address:$2 \
		-event-handler /srv/bin/event-router
}

echo "---> Starting alpha"
docker run -d --name alpha -i -t -p 7946:7946 -p 7946:7946/udp vlipco/deckhouse serf \
		agent -node alpha -rpc-addr 0.0.0.0:7373 -advertise $routable_address:7946 \
		-event-handler /srv/bin/event-router

start_node beta 7947
start_node gamma 7949
start_node delta 7950